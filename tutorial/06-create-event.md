---
ms.openlocfilehash: 0d7c9cc909e2f848cc9760d5862bb1863501f02b
ms.sourcegitcommit: 523e64e972f247e2df57cd8de949ac7bd1b8b047
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2020
ms.locfileid: "48823386"
---
<!-- markdownlint-disable MD002 MD041 -->

В этом разделе вы обновите веб-часть, чтобы позволить пользователю добавить событие в свой календарь для еженедельного социальныхого часа группы. В этом сценарии у группы есть еженедельный социальный час с 4 по пятницу.

1. Откройте **./СРК/вебпартс/графтуториал/графтуториалвебпарт.ТС** и замените существующий `addSocialToCalendar()` метод на приведенный ниже.

    :::code language="typescript" source="../demo/graph-tutorial/src/webparts/graphTutorial/GraphTutorialWebPart.ts" id="addSocialToCalendarSnippet":::

    Рассмотрите, что делает этот код.

    - Он определяет следующую предстоящую пятницу и создает **дату** для 4 РМ в этот день.
    - Он создает новый объект **MicrosoftGraph. Event** , устанавливая для него значение **даты** и заканчивая на час позже.
    - Он использует **MSGraphClient** для публикации нового события в `/me/events` конечной точке.
    - Он повторно отрисовывает веб-часть, чтобы представление обновлялось с новым событием.

1. Выполните построение, упаковку и повторную отправку веб-части, а затем обновите страницу, на которой она тестируется.

1. Нажмите кнопку **Добавить группу социального контента** . После обновления страницы прокрутите окно вниз до пункта пятница и найдите новое событие.

    ![Снимок экрана: вновь созданное событие, отображаемое в веб-части](images/new-event.png)
