---
ms.openlocfilehash: ee9addcbcf58fa971b3e67fb3d84cfb36bf275dd
ms.sourcegitcommit: 523e64e972f247e2df57cd8de949ac7bd1b8b047
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2020
ms.locfileid: "48823426"
---
<!-- markdownlint-disable MD002 MD041 -->

В этом разделе описывается использование [набора средств Microsoft Graph](https://docs.microsoft.com/graph/toolkit/overview) для замены простого списка событий с богатым пользовательским интерфейсом.

Набор средств предоставляет [компонент повестки](https://docs.microsoft.com/graph/toolkit/components/agenda), который хорошо подходит для отображения нашего списка событий.

## <a name="update-the-web-part"></a>Обновление веб-части

1. Открыть **./СРК/вебпартс/графтуториал/графтуториалвебпарт.модуле.СКСс**. Измените значение `background-color` атрибута в `.row` записи на `$ms-color-white` .

    :::code language="css" source="../demo/graph-tutorial/src/webparts/graphTutorial/GraphTutorialWebPart.module.scss" id="rowScssSnippet" highlight="4":::

1. Добавьте следующую запись в `.graphTutorial` запись.

    :::code language="css" source="../demo/graph-tutorial/src/webparts/graphTutorial/GraphTutorialWebPart.module.scss" id="addSocialBtnSnippet":::

1. Откройте **./СРК/вебпартс/графтуториал/графтуториалвебпарт.ТС** и добавьте приведенный ниже `import` оператор в начало файла.

    ```typescript
    import { Providers, SharePointProvider, MgtAgenda } from '@microsoft/mgt';
    ```

1. Добавьте указанную ниже функцию в класс **графтуториалвебпарт** , чтобы инициализировать набор инструментов.

    :::code language="typescript" source="../demo/graph-tutorial/src/webparts/graphTutorial/GraphTutorialWebPart.ts" id="onInitSnippet":::

1. Замените имеющуюся функцию `renderCalendarView` указанным ниже кодом.

    :::code language="typescript" source="../demo/graph-tutorial/src/webparts/graphTutorial/GraphTutorialWebPart.ts" id="renderCalendarViewSnippet":::

    Этот базовый список заменяется компонентом **повестки** из набора инструментов.

1. Выполните построение, упаковку и повторную отправку веб-части, а затем обновите страницу, на которой она тестируется.

    ![Снимок экрана: веб-часть с компонентом повестки](images/mgt-agenda.png)

## <a name="an-alternate-approach"></a>Альтернативный подход

На этом шаге у вас есть код, который:

- Использование **MSGraphClient** для получения представления календаря пользователя за текущую неделю из Microsoft Graph.
- Добавьте эти события в компонент **повестку** из набора средств Microsoft Graph.

Благодаря этому подходу вы получите полный контроль над вызовом API Graph и можете выполнить любую обработку событий перед отображением. Тем не менее, если это не требуется, вы можете упростить, разрешив компоненту **повестки** работать.

Все компоненты набора средств Microsoft Graph могут выполнять все подходящие вызовы API Microsoft Graph. Например, просто добавив компонент **повестки** в веб-часть, а не устанавливая свойства, веб-часть будет использовать параметры по умолчанию для получения событий за текущий день. Рассмотрим, как можно добиться того же результата (события за текущую неделю).

1. Замените существующий `render` метод на приведенный ниже.

    :::code language="typescript" source="../demo/graph-tutorial/src/webparts/graphTutorial/GraphTutorialWebPart.ts" id="alternateRenderSnippet":::

    Теперь, вместо вызова API в `render` , просто добавьте `mgt-agenda` элемент непосредственно в HTML. При установке `date` на начало недели и `days` до 7 компонент будет выполнять тот же вызов API, что и Предыдущая версия `render` .

1. Добавьте следующую пустую функцию в класс **графтуториалвебпарт** .

    ```typescript
    private async addSocialToCalendar() {}
    ```

    > [!NOTE]
    > Мы также добавили в веб-часть кнопку **Добавить группу социального контента** и добавили метод в `addSocialToCalendar` качестве прослушивателя событий.  Вы реализуете код, приведенный в следующем разделе. Пока хотите, чтобы код был скомпилирован.

1. Выполните построение, упаковку и повторную отправку веб-части, а затем обновите страницу, на которой она тестируется. Представление должно совпадать с предыдущим тестом.

### <a name="using-the-toolkit-vs-making-api-calls"></a>Использование вызовов API для набора средств и совершения вызовов API

На этом шаге вы, возможно, захотите узнать, почему у вас возникли проблемы с использованием **MSGraphClient** , когда набор инструментов выполняет свою работу. Набор средств разработки предназначен для отображения результатов, которые вы запрашиваете из Microsoft Graph, например списка событий. Однако существуют сценарии, в которых необходимо самостоятельно совершать вызовы API.

- Все вызовы API, которые не являются `GET` запросами. Например, создание нового события в календаре или обновление номера телефона пользователя.
- Вызовы API для получения данных, которые предназначены для использования в фоновом режиме и не отображаются напрямую.
